<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard</title>

  <!-- ðŸ’„ Einfache Styles fÃ¼r bessere Lesbarkeit -->
  <style>
    body {
      font-family: sans-serif;
      background-color: #f3f4f6; /* hellgrauer Hintergrund */
      padding: 2rem;
      color: #111827; /* dunkle Schrift */
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1); /* Schatteneffekt */
    }
    h1 {
      color: #10b981; /* grÃ¼n */
    }
    p {
      margin-bottom: 1rem;
    }
    strong {
      display: inline-block;
      width: 200px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ðŸŽ‰ Willkommen im geheimen Dashboard</h1>
    <p>Nur sichtbar, wenn du korrekt eingeloggt bist!</p>

    <!-- Hier werden die Daten aus der Datenbank angezeigt -->
    <p><strong>E-Mail:</strong> <span id="email">Lade...</span></p>
    <p><strong>Gruppenfahrt 2025:</strong> <span id="fahrt">â€“</span></p>
    <p><strong>Gruppenkasse 2025:</strong> <span id="kasse">â€“</span></p>
  </div>

  <script>
    // Sobald die Seite geladen ist:
    document.addEventListener('DOMContentLoaded', async () => {
      const email = localStorage.getItem('email') // E-Mail aus localStorage holen

      if (!email) {
        alert('Keine E-Mail gefunden. Bitte neu einloggen.')
        return
      }

      try {
        // Anfrage an den Node.js-Server, um Nutzerdaten zu laden
        const res = await fetch('http://192.168.178.86:8080/userdata', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email }) // E-Mail im Request senden
        })

        const result = await res.json() // Antwort als JSON lesen

        // Wenn erfolgreich â†’ Daten in HTML schreiben
        if (result.success) {
          document.getElementById('email').textContent = result.data.email
          document.getElementById('fahrt').textContent = result.data.gruppenfahrt_2025 + ' â‚¬'
          document.getElementById('kasse').textContent = result.data.gruppenkasse_2025 + ' â‚¬'
        } else {
          alert('Fehler beim Laden der Daten: ' + result.message)
        }
      } catch (err) {
        // Wenn der Server nicht erreichbar ist
        alert('Verbindungsfehler zum Server.')
        console.error(err)
      }
    })
  </script>
</body>
</html>

